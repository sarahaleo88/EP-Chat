# EP (Enhanced Prompt) 环境变量配置文件
# 复制此文件为 .env 并填入实际值

# =============================================================================
# 🔑 API 配置
# =============================================================================

# DeepSeek API 密钥 (必需)
# 获取地址: https://platform.deepseek.com/api_keys
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# DeepSeek API 基础 URL (可选，默认为官方 API)
# DEEPSEEK_API_BASE=https://api.deepseek.com

# =============================================================================
# 🌐 应用配置
# =============================================================================

# 应用运行环境
NODE_ENV=production

# 应用端口
PORT=3000

# 应用主机名
HOSTNAME=0.0.0.0

# 应用基础 URL (用于生成绝对链接)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# 禁用 Next.js 遥测
NEXT_TELEMETRY_DISABLED=1

# =============================================================================
# 🔒 安全配置
# =============================================================================


# CORS 允许的源 (多个用逗号分隔)
# CORS_ORIGINS=http://localhost:3000,https://yourdomain.com

# =============================================================================
# 📊 缓存配置 (可选)
# =============================================================================

# Redis 连接配置
# REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=ep-redis-pass

# 模板缓存过期时间 (秒)
# TEMPLATE_CACHE_TTL=3600

# API 响应缓存过期时间 (秒)
# API_CACHE_TTL=300

# =============================================================================
# 📝 日志配置
# =============================================================================

# 日志级别 (error, warn, info, debug)
LOG_LEVEL=info

# 日志格式 (json, pretty)
LOG_FORMAT=json

# 日志文件路径
# LOG_FILE=./logs/app.log

# =============================================================================
# 🚀 性能配置
# =============================================================================

# API 请求超时时间 (毫秒) - 基础连接超时
API_TIMEOUT=30000

# 长文本生成超时配置 (毫秒)
# 流式响应超时 - 用于长文本生成过程中的总体超时
STREAMING_TIMEOUT=300000

# 数据块间隔超时 - 两个数据块之间的最大等待时间
CHUNK_INTERVAL_TIMEOUT=30000

# 续写段超时 - 自动续写每个段落的超时时间
CONTINUATION_TIMEOUT=180000

# 最大并发请求数
MAX_CONCURRENT_REQUESTS=10

# 请求频率限制 (每分钟)
RATE_LIMIT_PER_MINUTE=60

# =============================================================================
# 🤖 DeepSeek v3.1 模型配置
# =============================================================================

# 默认模型名称
MODEL_NAME=deepseek-v3.1

# 模型能力回退配置（探测失败时使用）
MODEL_CTX=131072
MODEL_RATE_LIMIT_RPS=0.5
MODEL_MAX_OUTPUT_PER_REQ=30000
MODEL_SUPPORTS_REASONING=false

# 价格配置 (USD/1K tokens)
PRICE_IN_PER_1K=0.0014
PRICE_OUT_PER_1K=0.0028
PRICE_REASON_PER_1K=0.0056

# =============================================================================
# 💰 三级预算守护配置
# =============================================================================

# 预算硬上限
BUDGET_REQ_USD=0.40
BUDGET_USER_DAILY_USD=2.50
BUDGET_SITE_HOURLY_USD=8.00

# 并发限流
RL_MAX_CONCURRENCY_PER_USER=1
RL_RPS_PER_USER=0.03
RL_MAX_ACTIVE_STREAMS=40

# =============================================================================
# 📝 预算感知续写配置
# =============================================================================

# 续写策略
RESERVE_OUTPUT=4096
SAFETY_MARGIN=1024
CONTINUATION_TOKENS=28000
CONTINUATION_OVERLAP=600
CONTINUATION_MAX=6
SUMMARY_THRESHOLD=0.1

# 超时与心跳
SSE_HEARTBEAT_MS=30000
MODEL_API_TIMEOUT_MS=7200000

# =============================================================================
# 🎛️ 特性开关
# =============================================================================

# 128K模式开关
EP_128K_MODE=enabled

# 自动续写开关
EP_AUTO_CONTINUATION=true

# 长文本守护开关
EP_LONG_OUTPUT_GUARD=on

# 虚拟滚动开关
EP_VIRTUAL_SCROLL=true

# 增量渲染开关
EP_INCREMENTAL_RENDER=true

# Prometheus监控开关
PROM_ENABLED=true

# 日志级别
LOG_LEVEL=info

# =============================================================================
# 🔧 开发配置
# =============================================================================

# 开发模式下的调试选项
# DEBUG=ep:*

# 热重载配置
# FAST_REFRESH=true

# 源码映射
# GENERATE_SOURCEMAP=true

# =============================================================================
# 📱 功能开关
# =============================================================================

# 启用模板缓存
ENABLE_TEMPLATE_CACHE=true

# 启用 API 缓存
ENABLE_API_CACHE=false

# 启用请求日志
ENABLE_REQUEST_LOGGING=true

# 启用性能监控
ENABLE_PERFORMANCE_MONITORING=false

# 启用错误报告
ENABLE_ERROR_REPORTING=false

# =============================================================================
# 🌍 国际化配置
# =============================================================================

# 默认语言
DEFAULT_LANGUAGE=zh

# 支持的语言 (逗号分隔)
SUPPORTED_LANGUAGES=zh,en

# =============================================================================
# 📈 监控配置 (可选)
# =============================================================================

# Sentry DSN (错误监控)
# SENTRY_DSN=your_sentry_dsn_here

# Google Analytics ID (访问统计)
# NEXT_PUBLIC_GA_ID=your_ga_id_here

# =============================================================================
# 🐳 Docker 配置
# =============================================================================

# Docker 镜像标签
# DOCKER_IMAGE_TAG=latest

# Docker 容器名称
# DOCKER_CONTAINER_NAME=ep-enhanced-prompt

# =============================================================================
# 💾 数据库配置 (如果需要持久化)
# =============================================================================

# 数据库 URL (如果启用用户系统)
# DATABASE_URL=postgresql://user:password@localhost:5432/ep_db

# 数据库连接池大小
# DATABASE_POOL_SIZE=10

# =============================================================================
# 📧 邮件配置 (如果需要通知功能)
# =============================================================================

# SMTP 配置
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your_email@gmail.com
# SMTP_PASS=your_app_password
# SMTP_FROM=EP Team <noreply@yourdomain.com>

# =============================================================================
# 🔍 搜索配置 (如果启用模板搜索)
# =============================================================================

# Elasticsearch URL
# ELASTICSEARCH_URL=http://localhost:9200

# 搜索索引名称
# SEARCH_INDEX_NAME=ep_templates

# =============================================================================
# 📊 分析配置
# =============================================================================

# 启用使用统计
ENABLE_USAGE_ANALYTICS=false

# 统计数据保留天数
ANALYTICS_RETENTION_DAYS=30
